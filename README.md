# База данных отдела продаж

База данных будет использоваться для отображения в приложении интернет-магазина покупок пользователя со списком товаров, наличия выбранных товаров в магазине, контактного номера магазина. При выборе доставки на дом - отображение даты доставки и информации о доставщике. Также покупатель имеет аккаунт с заполненными полями Имя, Номер телефона и Адрес.
С помощью базы данных можно собирать статистику для анализа продаж. База данных дает возможность анализировать информацию о покупателях и их покупках с целью повышения количества продаж. 

## Схема базы данных
![image](https://github.com/merf14/sales_database/assets/89605064/e1398847-2c48-439a-863b-ffef91476f1c)

## Заполнение базы данных
Заполнение базы данных тестовыми данными реализовано на Ruby с использованием гемов Sequel и Faker. 
Для заполнения необходимо запустить файл "fill_bd.rb", поменяв данные где необходимо.

## Реализованные функции
- Триггер на добавление нового пользователя. Проверяет правильность заполнения полей.
- Функция `product_stores(product text)`, выводящая для товара product список магазинов, в которых он в наличии.
- Функция `min_days(begin INT, end INT)`, выводящая для пользователей с номерами в заданном интервале (begin,end) минимальное количество дней , прошедшее между регистрацией пользователя и его первой покупкой.
- Функция `product_avg(product text)`, возвращающая среднюю цену товара product.

## Реализованные представления
- Представление `customer_summary` со столбцами номера покупателя и суммарной стоимости всех его попкупок.
